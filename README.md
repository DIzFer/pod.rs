# pod.sh

[pod.sh](http://cdsoft.fr/pod/index.html) is described as "a simple command line podcast aggregator". Inspired by [BashPodder](http://lincgeek.org/bashpodder/), it's a single file Bash script that fetches your podcast list and all new files to the specified folder.

The intended use is for it to be ran automatically by a cron-like software, or on startup. Which means, execution is unnatended. This matches my workflow: run the script every night on a VPS, which will download files to a [SyncThing](https://syncthing.net/) share synced to all my devices, where they will be listened to with the most appropiate audio (often, audiobook) player.

However, I'm easily bored. I started expanding the script: adding youtube feed support, making it more functional so that I could turn the download function into a no-op when I added new feeds whose backlog I don't need to listen to... Simple things. Eventually, something broke, and I couldn't get it to run correctly ever again. Which prompted me to rewrite it, in a different language I could learn from scratch. Hence...

# pod.rs

## Dependencies not fetched by cargo

 - openssl 1.1 (build)
 - pkgconfig

## Required (plain text) files

 - The `list` file

  This is where you specify how the program will run. The first line must consist of a path where podcast files will be downloaded to. The rest of the lines can be your subscriptions, with a name and their Å¬RL. Note I wrote some weird stuff so that, even if the parameters are whitespace separated, escaping spaces in the podcast name isn't needed. Example:

  ```
  ~/podcasts
  Linux Action News		http://linuxactionnews.com/rss
  New Rustacean			http://www.newrustacean.com/feed.xml
  ```

 - The `db` file

  A simple list of URLs to podcast files. Each time an episode is downloaded, its URL will be appended to this file so that the program knows on next run that it has already been downloaded. I _specifically_ made the decision not to create this file, and instead exit if it's not found, so that I don't end up accidentally downloading 7000 files because of a typo. An empty file is fine, as is the poddb generated by the original pod.sh. It's not neccessary to interact with this file any further after `touch`ing it for first run

## Running pod.rs

`pod.rs path/to/list path/to/poddb`

For example: 

`pod.rs ~/Sync/pod.rs/{list,poddb}`


NOTE: I recently decided to remove the reencoding functionality for several reasons:
  1. I don't have enough podcasts to last me all my commutes during a week. Listening to them faster doesn't do me any favours.
  2. There's no stable/easy to use crate for manipulating media on Rust. I hear good things about the GStreamer bindings... But I didn't manage to learn how they should be used. This is my first software project after all. Which leads us directly to:
  3. It was implemented with `std::process::Command`. Calling other executables feels wrong if done from anything other than a shell script.
  4. I have no idea how ffmpeg works, which resulted in a nested list of wrongdoings:
    1. It was hardcoded to opus files. Not that bad, but keep reading.
    2. I had to extract the cover art, because I have no idea what I'm doing and I couldn't keep it while transcoding.
    3. Said cover art would always output cover.jpg. Had the cover art encoded as a PNG image? Too bad. Since my podcast player of choice doesn't care about the file extension as long as it's an image extension with image content, I was lazy enough to leave it that way.
    4. I couldn't keep chapter markers, because I don't know what I'm doing.
    5. This afternoon I decided to check how much space was I saving by reencoding. Opus is magic after all, right? Well...
    ```
    $ du -hs ~/podcasts/Unplugged/2018-5-9-953278e5-4970-4b31-a985-81c9bad3f58b.mp3 /tmp/blarg.opus                                           ~
    62M     /home/mack/podcasts/Unplugged/2018-5-9-953278e5-4970-4b31-a985-81c9bad3f58b.mp3
    107M    /tmp/blarg.opus
    $ # Fuck that
    ```
  5. Someone told me that a podcast should be listened at the speed the author intended, as if they were a form of art. Someone other said that it was a pity that all the effort they put into encoding the bazillion tracks of the source into a perfect stereo was for nothing. I don't agree 100% with either of those arguments against, but 90% is enough to add to the previous points, even if just out of respect for the work they put on their podcasts.
